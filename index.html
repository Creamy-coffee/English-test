<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ëã±ËØ≠ÂèåÊïôÊùêÂÆåÊï¥ËÆ≠ÁªÉÁ≥ªÁªü</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #0984e3;
            --success: #00b894;
            --error: #d63031;
            --bg: #dfe6e9;
            --card: #ffffff;
            --text: #2d3436;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            padding-bottom: 100px;
            -webkit-tap-highlight-color: transparent;
        }

        /* È°∂ÈÉ®ÂØºËà™ */
        .header {
            background: linear-gradient(135deg, var(--primary), #34495e);
            color: white;
            padding: 15px 0 0 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .app-title {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .nav-tabs {
            display: flex;
            justify-content: space-around;
            padding: 0 10px;
        }

        .tab-btn {
            flex: 1;
            text-align: center;
            padding: 12px;
            font-size: 1rem;
            cursor: pointer;
            border-bottom: 4px solid transparent;
            transition: all 0.3s;
            opacity: 0.8;
        }

        .tab-btn.active {
            opacity: 1;
            font-weight: bold;
            border-bottom-color: var(--success);
            background: rgba(255,255,255,0.1);
            border-radius: 8px 8px 0 0;
        }

        /* ÂÜÖÂÆπÂå∫Âüü */
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }

        .unit-card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .unit-title {
            font-size: 1.3rem;
            color: var(--primary);
            border-left: 5px solid var(--accent);
            padding-left: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .section-title {
            font-size: 1.1rem;
            color: #636e72;
            margin: 20px 0 10px 0;
            border-bottom: 1px dashed #b2bec3;
            padding-bottom: 5px;
            font-weight: bold;
        }

        /* ÊñáÁ´†‰∏éÁøªËØë */
        .text-content {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            line-height: 1.8;
            font-family: Georgia, serif;
            font-size: 1.05rem;
            color: #2d3436;
            margin-bottom: 15px;
            white-space: pre-wrap;
        }

        .trans-content {
            background: #e6fffa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--success);
            font-size: 0.95rem;
            color: #2d3436;
            margin-top: 10px;
            display: none;
            line-height: 1.6;
        }

        /* È¢òÁõÆÊ†∑Âºè */
        .question-item {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .q-stem {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .options-grid {
            display: grid;
            gap: 8px;
        }

        .opt-btn {
            text-align: left;
            background: white;
            border: 1px solid #dfe6e9;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
            position: relative;
        }

        .opt-btn:active { background: #f1f2f6; }

        .opt-btn.correct { background: #d4edda; border-color: var(--success); color: #155724; }
        .opt-btn.wrong { background: #ff7675; border-color: var(--error); color: white; }
        
        .answer-key {
            display: none;
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--error);
            font-weight: bold;
            padding: 5px 10px;
            background: #fff5f5;
            border-radius: 4px;
        }

        /* Â∫ïÈÉ®ÊéßÂà∂Ê†è */
        .bottom-dock {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background: white;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.1);
            padding: 12px 15px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            z-index: 900;
        }

        .dock-btn {
            border: none;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .dock-btn:active { transform: scale(0.95); }

        .btn-trans { background: #ecf0f1; color: var(--primary); }
        .btn-ans { background: #ecf0f1; color: var(--primary); }
        .btn-ans.active, .btn-trans.active { background: var(--accent); color: white; }
        .btn-dl { background: var(--success); color: white; }

        /* Áä∂ÊÄÅÊéßÂà∂ */
        body.show-trans .trans-content { display: block; }
        body.show-ans .answer-key { display: block; }

    </style>
</head>
<body>

<div class="header">
    <div class="app-title">Ëã±ËØ≠ÂÖ®ËÉΩËÆ≠ÁªÉ (ÂÆåÊï¥Áâà)</div>
    <div class="nav-tabs">
        <div class="tab-btn active" onclick="switchBook('book1')">üìö ÁªºÂêàÊïôÁ®ã</div>
        <div class="tab-btn" onclick="switchBook('book2')">üìñ ÈòÖËØªÊïôÁ®ã</div>
    </div>
</div>

<div class="container" id="content-area">
    </div>

<div class="bottom-dock">
    <button class="dock-btn btn-trans" onclick="toggleTrans()">‰∏≠Ëã±ÂØπÁÖß</button>
    <button class="dock-btn btn-ans" onclick="toggleAns()">ÊòæÁ§∫Á≠îÊ°à</button>
    <button class="dock-btn btn-dl" onclick="exportWord()">ÂØºÂá∫ Word</button>
</div>

<script>
    // ==========================================
    // Ê†∏ÂøÉÊï∞ÊçÆÊ∫ê (Data Source)
    // ==========================================
    
    const db = {
        // BOOK 1: ÁªºÂêàÊïôÁ®ã (Comprehensive Course)
        book1: [
            {
                unit: "Unit 1: Bringing Dreams to Life",
                sections: [
                    {
                        title: "Vocabulary",
                        content: "Choose the appropriate word or expression.",
                        questions: [
                            { q: "1. They did not realise that they were being _____ into a trap.", opts: ["A. stumbled", "B. lured", "C. treaded", "D. slipped"], ans: "B" },
                            { q: "2. You should get out your English books and _____ your reading assignments.", opts: ["A. move on", "B. pursue on", "C. follow on", "D. catch up on"], ans: "D" },
                            { q: "3. She bears a _____ resemblance to her older sister.", opts: ["A. striking", "B. different", "C. prestigious", "D. notorious"], ans: "A" },
                            { q: "4. Before she _____ in Portugal, she had run her own antiques shop.", opts: ["A. settled down", "B. settled up", "C. settled on", "D. settled away"], ans: "A" },
                            { q: "5. He's realistic enough to know he's not going to succeed _____.", opts: ["A. hastily", "B. hurriedly", "C. rashly", "D. overnight"], ans: "D" }
                        ]
                    },
                    {
                        title: "Listening: Long Conversation",
                        text: "Script:\nM: Morning, Penny, I know you are one of a few women taxi drivers in the city now...\nW: I can still remember when I was first learning to drive. I didn't know how to judge distance.\nM: Then, what's the best part of your job?\nW: What I like best about the job was being outdoors, seeing how this city changes from season to season...\n(Penny discusses her job satisfaction, vacation preferences, and annual leave.)",
                        trans: "„ÄêÂê¨ÂäõÁøªËØë„Äë\nÁî∑ÔºöÊó©‰∏äÂ•ΩÔºåPenny„ÄÇÊàëÁü•ÈÅì‰Ω†ÊòØËøô‰∏™ÂüéÂ∏Ç‰∏∫Êï∞‰∏çÂ§öÁöÑÂ•≥Âá∫ÁßüËΩ¶Âè∏Êú∫‰πã‰∏Ä...\nÂ•≥ÔºöÊàëËøòËÆ∞ÂæóÂàöÂ≠¶ËΩ¶ÁöÑÊó∂ÂÄôÔºåÊàë‰∏çÊáÇÂæóÂà§Êñ≠Ë∑ùÁ¶ª„ÄÇ\nÁî∑ÔºöÈÇ£‰Ω†Â∑•‰Ωú‰∏≠ÊúÄÊ£íÁöÑÈÉ®ÂàÜÊòØ‰ªÄ‰πàÔºü\nÂ•≥ÔºöÊàëÊúÄÂñúÊ¨¢ÁöÑÊòØÂú®Êà∑Â§ñÔºåÁúãÁùÄËøôÂ∫ßÂüéÂ∏ÇÂõõÂ≠£ÁöÑÂèòÂåñ...",
                        questions: [
                            { q: "1. What was the most difficult for Penny to become a taxi driver?", opts: ["A. Judging distance", "B. Judging direction", "C. Lack of experience", "D. Lack of skills"], ans: "A" },
                            { q: "2. What does Penny like best about her job?", opts: ["A. Seeing buildings", "B. Long drives", "C. Being outdoors & changes", "D. Weather"], ans: "C" },
                            { q: "3. What will Penny try to avoid when she goes on vacation?", opts: ["A. Driving on her own", "B. Taking a train", "C. Booking tickets", "D. Being driven"], ans: "A" },
                            { q: "4. What do we know about Penny?", opts: ["A. Only woman driver", "B. 10 days leave", "C. Driving for 12 years", "D. Plans to change job"], ans: "C" }
                        ]
                    },
                    {
                        title: "Listening: Passage (Unemployment)",
                        text: "Script: Organizations like the World Bank... expect the international economy to perform better... Yet one UN agency worries that economic progress is not creating enough jobs... The ILO released a report... unemployment numbers represent an increase... Much of the increase came from East and South Asia...",
                        trans: "„ÄêÂê¨ÂäõÁøªËØë„ÄëÂÉè‰∏ñÁïåÈì∂Ë°åËøôÊ†∑ÁöÑÁªÑÁªáÈ¢ÑËÆ°ÂõΩÈôÖÁªèÊµéË°®Áé∞‰ºöÊõ¥Â•Ω... ‰ΩÜËÅîÂêàÂõΩÊüêÊú∫ÊûÑÊãÖÂøÉÁªèÊµéËøõÊ≠•Ê≤°ÊúâÂàõÈÄ†Ë∂≥Â§üÁöÑÂ∞±‰∏öÊú∫‰ºö... ÂõΩÈôÖÂä≥Â∑•ÁªÑÁªá(ILO)ÂèëÂ∏ÉÁöÑÊä•ÂëäÊòæÁ§∫Â§±‰∏ö‰∫∫Êï∞Â¢ûÂä†ÔºåÂÖ∂‰∏≠Â§ßÈÉ®ÂàÜÂ¢ûÈïøÊù•Ëá™‰∏ú‰∫öÂíåÂçó‰∫ö...",
                        questions: [
                            { q: "5. What is the United Nations agency worried about?", opts: ["A. Too many people", "B. Economic crisis", "C. Jobs created are insufficient", "D. Old people unemployed"], ans: "C" },
                            { q: "6. Where is the increased world unemployment mostly from?", opts: ["A. Africa", "B. East and South Asia", "C. North America", "D. South America"], ans: "B" },
                            { q: "7. What do we know about youth unemployment?", opts: ["A. Over 30%", "B. Particular victims of unemployment", "C. Female concern", "D. Aged 14-25"], ans: "B" }
                        ]
                    }
                ]
            },
            {
                unit: "Unit 2: Say It Your Way",
                sections: [
                    {
                        title: "Vocabulary",
                        questions: [
                            { q: "1. In terms of word-formation, they can be borrowed by means of _____, compounding and blending.", opts: ["A. affixation", "B. suffix", "C. prefix", "D. abbreviation"], ans: "A" },
                            { q: "2. Let's _____ it vertically.", opts: ["A. splash", "B. squish", "C. spot", "D. spread"], ans: "B" },
                            { q: "3. The university gets a government _____.", opts: ["A. ground", "B. grant", "C. group", "D. grief"], ans: "B" }
                        ]
                    },
                    {
                        title: "Listening: Long Conversation (Diamonds Galore)",
                        text: "Script:\nSmith: Hello, Diamonds Galore, this is Peter speaking...\nAnderson: Yes, this is Ms. Anderson calling... We still haven't received the shipment of earrings that was supposed to arrive last Tuesday...\nSmith: I'm afraid Mr. Franks is meeting with some clients out of town on Thursday afternoon...",
                        trans: "„ÄêÂê¨ÂäõÁøªËØë„Äë\nSmith: ‰Ω†Â•ΩÔºåDiamonds GaloreÔºåÊàëÊòØPeter...\nAnderson: ‰Ω†Â•ΩÔºåÊàëÊòØAndersonÂ•≥Â£´„ÄÇÊàë‰ª¨ËøòÊ≤°Êî∂Âà∞Êú¨ËØ•‰∏äÂë®‰∫åÂà∞ÁöÑËÄ≥ÁéØ...\nSmith: ÊÅêÊÄïFranksÂÖàÁîüÂë®Âõõ‰∏ãÂçàË¶ÅÂéªÂ§ñÂú∞ËßÅÂÆ¢Êà∑...",
                        questions: [
                            { q: "1. Why did Ms. Anderson call?", opts: ["A. Set meeting", "B. Discuss business", "C. Check schedule", "D. Talk about delivery problem"], ans: "D" },
                            { q: "2. When will the earrings arrive?", opts: ["A. Tuesday", "B. Thursday", "C. Next morning", "D. Arrived"], ans: "C" },
                            { q: "3. What will Mr. Franks do Thursday afternoon?", opts: ["A. Staff meeting", "B. Meeting Ms. Anderson", "C. Meeting downtown", "D. Meeting clients out of town"], ans: "D" },
                            { q: "4. When is the meeting scheduled?", opts: ["A. 9 Friday", "B. 10 Friday", "C. 9 Thursday", "D. 10 Thursday"], ans: "B" }
                        ]
                    },
                    {
                        title: "Listening: Passage (Baidu Baike)",
                        text: "Script: The Baidu Baike, China's Wikipedia equivalent, revealed a list of the Top 5 Trendy Internet Slang Words... 1. Diss... 2. Let's go, Mantis Shrimp... 3. Finger Heart Sign... 4. Roll up our sleeves... 5. Winner, winner, chicken dinner...",
                        trans: "„ÄêÂê¨ÂäõÁøªËØë„ÄëÁôæÂ∫¶ÁôæÁßëÂÖ¨Â∏É‰∫Ü2017Âπ¥‰∫îÂ§ßÁΩëÁªúÊµÅË°åËØ≠... 1. DissÔºàÊÄºÔºâ... 2. ÁöÆÁöÆËôæÊàë‰ª¨Ëµ∞... 3. ÊØîÂøÉ... 4. Êí∏Ëµ∑Ë¢ñÂ≠êÂä†Ê≤πÂπ≤... 5. Â§ßÂêâÂ§ßÂà©ÔºåÊôö‰∏äÂêÉÈ∏°...",
                        questions: [
                            { q: "5. What's the main idea?", opts: ["A. Yearly report", "B. Intro of Baidu", "C. 2018 slang", "D. 2017 trendy slang"], ans: "D" },
                            { q: "6. How is the list formed?", opts: ["A. Annual survey", "B. Most commonly searched words", "C. Annual research", "D. Vote"], ans: "B" },
                            { q: "7. What is Baidu Baike?", opts: ["A. Wikipedia Chinese", "B. Popular website", "C. Called China's Wikipedia", "D. Research website"], ans: "C" }
                        ]
                    }
                ]
            },
            {
                unit: "Unit 3: To the Rescue!",
                sections: [
                    {
                        title: "Vocabulary & Listening",
                        text: "Script (Lecture on New Orleans): In Louisiana, or more specifically, New Orleans, there have been a few major cultural influences... Unlike the rest of the US, which was colonized by England and Spain, New Orleans was mainly a French settlement... It became a 'garden salad' where each piece retains its identity...",
                        trans: "„ÄêÂê¨ÂäõÁøªËØë„ÄëÂú®Ë∑ØÊòìÊñØÂÆâÈÇ£Â∑ûÔºåÁâπÂà´ÊòØÊñ∞Â••Â∞îËâØÔºåÊúâ‰∏Ä‰∫õ‰∏ªË¶ÅÁöÑÊñáÂåñÂΩ±Âìç... ‰∏éË¢´Ëã±Ê≥ïÊÆñÊ∞ëÁöÑÁæéÂõΩÂÖ∂‰ªñÂú∞Âå∫‰∏çÂêåÔºåÊñ∞Â••Â∞îËâØ‰∏ªË¶ÅÊòØÊ≥ïÂõΩÂÆöÂ±ÖÁÇπ... ÂÆÉÂèòÊàê‰∫Ü‰∏Ä‰∏™‚ÄòËä±Âõ≠Ê≤ôÊãâ‚ÄôÔºåÊØè‰∏ÄÈÉ®ÂàÜÈÉΩ‰øùÁïô‰∫ÜËá™Â∑±ÁöÑÁâπÊÄß...",
                        questions: [
                            { q: "1. Video cameras with night vision can be _____ by movement.", opts: ["A. highlighted", "B. activated", "C. upgraded", "D. promoted"], ans: "B" },
                            { q: "8 (Listening). What's the difference between New Orleans and rest of US?", opts: ["A. Colonized by England", "B. More cultural influences", "C. Melting pot", "D. Greatly influenced by French culture"], ans: "D" },
                            { q: "9 (Listening). What do we know about a garden salad?", opts: ["A. Many parts make new flavor", "B. Better than melting pot", "C. Each piece makes flavor", "D. Loses identity"], ans: "A" }
                        ]
                    }
                ]
            },
            {
                unit: "Unit 4: Beyond Limits",
                sections: [
                    {
                        title: "Vocabulary & Listening",
                        text: "Script (Andrew Becroft): I attended a school prize-giving ceremony... guest speaker was Andrew Becroft, who had a severe stutter as a child. Instead of allowing this to limit him, he chose to work hard... He is now the Principal Youth Court Judge...",
                        trans: "„ÄêÂê¨ÂäõÁøªËØë„ÄëÊàëÂèÇÂä†‰∫Ü‰∏Ä‰∏™È¢ÅÂ•ñÂÖ∏Á§º... ÊºîËÆ≤ÂòâÂÆæÊòØAndrew BecroftÔºå‰ªñÂ∞èÊó∂ÂÄôÊúâ‰∏•ÈáçÁöÑÂè£ÂêÉ„ÄÇ‰ΩÜ‰ªñÊ≤°ÊúâÂèóÈôêÔºåËÄåÊòØÂä™ÂäõÂÖãÊúç... ‰ªñÁé∞Âú®ÊòØÈ¶ñÂ∏≠ÈùíÂπ¥Ê≥ïÂ∫≠Ê≥ïÂÆò...",
                        questions: [
                            { q: "1. This disorder is easily _____ but not so easily treated.", opts: ["A. diagnosed", "B. realized", "C. explored", "D. emerged"], ans: "A" },
                            { q: "8 (Listening). Positive attitude towards weaknesses?", opts: ["A. Feel inferior", "B. Get help", "C. Rise above limitations", "D. Accept them"], ans: "C" },
                            { q: "9 (Listening). Andrew Becroft's profession?", opts: ["A. Orator", "B. Judge", "C. Presenter", "D. Principal"], ans: "B" }
                        ]
                    }
                ]
            },
            {
                unit: "Unit 5: Stress: Friend or Foe?",
                sections: [
                    {
                        title: "Vocabulary & Listening",
                        text: "Script (Business Etiquette): In India, you must not drink alcohol on the 1st and 7th of the month... In Arab countries, don't admire host's possessions too much... In Thailand, don't snap fingers for waiter...",
                        trans: "„ÄêÂê¨ÂäõÁøªËØë„ÄëÂú®Âç∞Â∫¶ÔºåÊØèÊúà1Âè∑Âíå7Âè∑‰∏çËÉΩÂñùÈÖí... Âú®ÈòøÊãâ‰ºØÂõΩÂÆ∂Ôºå‰∏çË¶ÅËøáÂ∫¶ËµûÁæé‰∏ª‰∫∫ÁöÑË¥¢Áâ©... Âú®Ê≥∞ÂõΩÔºå‰∏çË¶ÅÊâìÂìçÊåáÂè´ÊúçÂä°Âëò...",
                        questions: [
                            { q: "1. Bad habits can be described as _____.", opts: ["A. mortal", "B. chronic", "C. chronicle", "D. eternal"], ans: "B" },
                            { q: "8 (Listening). Doing business with foreigners?", opts: ["A. Learn language", "B. Study courses", "C. Learn from them", "D. Respect traditions"], ans: "D" },
                            { q: "9 (Listening). Avoid in India?", opts: ["A. Admire possessions", "B. Click fingers", "C. Drink alcohol on 1st/7th", "D. Make appointment late"], ans: "C" }
                        ]
                    }
                ]
            }
        ],

        // BOOK 2: ÈòÖËØªÊïôÁ®ã (Reading Course)
        book2: [
            {
                unit: "Unit 1: Adversities and Courage",
                sections: [
                    {
                        title: "Text A: Three Days to See",
                        text: "All of us have read thrilling stories in which the hero had only a limited and specified time to live. Sometimes it was as long as a year; sometimes as short as 24 hours... I have often thought it would be a blessing if each human being were stricken blind and deaf for a few days at some time during his early adult life. Darkness would make him more appreciative of sight; silence would teach him the joys of sound...\nI who cannot see find hundreds of things to interest me through mere touch. I feel the delicate symmetry of a leaf. I pass my hands lovingly about the smooth skin of a silver birch... If I can get so much pleasure from mere touch, how much more beauty must be revealed by sight? Yet, those who have eyes apparently see little.",
                        trans: "„ÄêText A ÁøªËØë„ÄëÊàë‰ª¨ÈÉΩËØªËøá‰∏Ä‰∫õÂä®‰∫∫ÂøÉÈ≠ÑÁöÑÊïÖ‰∫ãÔºåÊïÖ‰∫ã‰∏≠ÁöÑ‰∏ª‰∫∫ÂÖ¨Âè™ËÉΩÊ¥ª‰∏ÄÊÆµÊúâÈôêÁöÑÊó∂Èó¥... ÊàëÂ∏∏ÊÉ≥ÔºåÂ¶ÇÊûúÊØè‰∏™‰∫∫Âú®ÊàêÂπ¥Êó©ÊúüÁöÑÊüê‰∏™Êó∂ÂÄôÈÉΩÂ§±Êòé„ÄÅÂ§±ËÅ™Âá†Â§©ÔºåÈÇ£Â∞ÜÊòØ‰∏ÄÁßçÁ•ùÁ¶è„ÄÇÈªëÊöó‰ºöËÆ©‰ªñÊõ¥Âä†ÁèçÊÉúËßÜÂäõÔºõÂØÇÈùô‰ºöÊïôÂØº‰ªñÂ£∞Èü≥ÁöÑÂø´‰πê...\nÊàëËøô‰∏™Áúã‰∏çËßÅÁöÑ‰∫∫Ôºå‰ªÖ‰ªÖÈÄöËøáËß¶ËßâÂ∞±ËÉΩÂèëÁé∞Êï∞Áôæ‰ª∂ËÆ©ÊàëÊÑüÂÖ¥Ë∂£ÁöÑ‰∫ãÊÉÖ„ÄÇÊàëÊë∏Âà∞Âè∂Â≠êÁ≤æËá¥ÁöÑÂØπÁß∞ÔºåÊàëÊäöÊë∏ÁôΩÊ°¶Ê†ëÂÖâÊªëÁöÑÊ†ëÁöÆ... Â¶ÇÊûúÊàë‰ªÖÂá≠Ëß¶ËßâÂ∞±ËÉΩËé∑ÂæóÂ¶ÇÊ≠§Â§öÁöÑ‰πêË∂£ÔºåÈÇ£‰πàËßÜÂäõËØ•ËÉΩÊè≠Á§∫Â§öÂ∞ëÁæéÂë¢ÔºüÁÑ∂ËÄåÔºåÈÇ£‰∫õÊúâÁúºÁùõÁöÑ‰∫∫‰ºº‰πéËßÜËÄå‰∏çËßÅ„ÄÇ",
                        questions: [
                            { q: "1. The author‚Äôs main purpose is to tell the readers ______.", opts: ["A. she had only three days to see", "B. what they could see", "C. importance of treasuring lifetime & senses", "D. adopt epicurean motto"], ans: "C" },
                            { q: "2. Live each day as if we should die tomorrow because ______.", opts: ["A. we die one day", "B. pay attention to values of life", "C. nobody sure what happens", "D. ready to die"], ans: "B" },
                            { q: "3. 'Lethargy' means ______.", opts: ["A. listlessness", "B. energy", "C. vigor", "D. pessimism"], ans: "A" },
                            { q: "4. If stricken blind and deaf for a few days?", opts: ["A. See nothing forever", "B. Feel sad", "C. Learn to appreciate sight/sound", "D. Live not as well"], ans: "C" },
                            { q: "5. As human beings, we ______.", opts: ["A. appreciate what we have", "B. seldom expect", "C. fully use", "D. value little what we have"], ans: "D" }
                        ]
                    },
                    {
                        title: "Text B: How Love Endures",
                        text: "It's a year I could never have imagined happening... My husband, Rick, was the commander of the space shuttle Columbia... He went to his eternal home in heaven when the shuttle broke apart... Rick told me about his dream of being an astronaut... Grief seems to bring time to a halt. Yet love never stands still. Love is always going on.",
                        trans: "„ÄêText B ÁøªËØë„ÄëËøôÊòØÊàë‰ªéÊú™ÊÉ≥Ëøá‰ºöÂèëÁîüÁöÑ‰∏ÄÂπ¥... ÊàëÁöÑ‰∏àÂ§´RickÊòØÂì•‰º¶ÊØî‰∫öÂè∑Ëà™Â§©È£ûÊú∫ÁöÑÊåáÊå•ÂÆò... ÂΩìËà™Â§©È£ûÊú∫Ëß£‰ΩìÊó∂Ôºå‰ªñÂéª‰∫ÜÂ§©Â†Ç... RickÊõæÂëäËØâÊàë‰ªñÊÉ≥Êàê‰∏∫ÂÆáËà™ÂëòÁöÑÊ¢¶ÊÉ≥... ÊÇ≤‰º§‰ºº‰πéËÆ©Êó∂Èó¥ÂÅúÊªûÔºå‰ΩÜÁà±‰ªé‰∏çÊ≠¢Ê≠•„ÄÇÁà±Âú®Âª∂Áª≠„ÄÇ",
                        questions: [
                            { q: "1. What was Rick's dream?", opts: ["A. Master's degree", "B. Pilot hours", "C. Being an astronaut", "D. Exchange program"], ans: "C" },
                            { q: "2. True statement about Rick's pursuit?", opts: ["A. Applied 4 times", "B. Training in England", "C. Pilot of Discovery", "D. Air Force -> Dream came true"], ans: "D" },
                            { q: "3. Sweet memories EXCEPT?", opts: ["A. English countryside moments", "B. Devotion", "C. Sweet music", "D. Laughter"], ans: "A" },
                            { q: "4. Which is TRUE?", opts: ["A. Challenger exploded after", "B. Commander of Discovery", "C. Left when Challenger exploded", "D. One successful mission before Columbia"], ans: "D" },
                            { q: "5. What helped her through bereavement?", opts: ["A. Time", "B. Listener", "C. Lover", "D. Love is source of strength"], ans: "D" }
                        ]
                    }
                ]
            },
            {
                unit: "Unit 2: Shopping and Consumption",
                sections: [
                    {
                        title: "Text A: Shopaholics of Our Time",
                        text: "Compulsive shopping is the uncontrollable desire to purchase items. Just as nearly every alcoholic starts out as a social drinker... With 90 percent of compulsive shoppers being women... It is a vicious cycle: Depression -> Impulse -> Letdown -> Guilt -> Depression. Is there a cure? Self-control, or professional help.",
                        trans: "„ÄêText A ÁøªËØë„ÄëÂº∫Ëø´ÊÄßË¥≠Áâ©ÊòØ‰∏ÄÁßçÊó†Ê≥ïÊéßÂà∂ÁöÑË¥≠‰π∞Ê¨≤Êúõ... 90%ÁöÑÂº∫Ëø´ÊÄßË¥≠Áâ©ËÄÖÊòØÂ•≥ÊÄß... ËøôÊòØ‰∏Ä‰∏™ÊÅ∂ÊÄßÂæ™ÁéØÔºöÊäëÈÉÅ -> ÂÜ≤Âä® -> Â§±ËêΩ -> ÂÜÖÁñö -> ÊäëÈÉÅ„ÄÇÊúâÊ≤ªÊÑàÊñπÊ≥ïÂêóÔºüËá™Âà∂ÂäõÔºåÊàñËÄÖ‰∏ì‰∏öÂ∏ÆÂä©„ÄÇ",
                        questions: [
                            { q: "1. Which statement is TRUE?", opts: ["A. Desire to keep up explains it", "B. Pleasure from bills", "C. Ignored problem", "D. Most vulnerable women suffer emotional problems"], ans: "D" },
                            { q: "2. NOT a contributing factor?", opts: ["A. Credit availability", "B. Ads", "C. Psychological problems", "D. Alcoholic drinks"], ans: "D" },
                            { q: "3. Vicious cycle illustration?", opts: ["A. Distress -> Relief...", "B. Depression -> Impulse -> Letdown -> Guilt -> Depression", "C. Shopping -> Depression...", "D. Depression -> Impulse -> Ads..."], ans: "B" }
                        ]
                    },
                    {
                        title: "Text B: The Psychology of Money",
                        text: "Are you a compulsive spender? Psychologists say money habits show our beliefs. Money symbolizes power or love. Compulsive bargain hunters buy things just because they are cheap to feel they are 'winning'.",
                        trans: "„ÄêText B ÁøªËØë„Äë‰Ω†ÊòØÂº∫Ëø´ÊÄßÊ∂àË¥πËÄÖÂêóÔºüÂøÉÁêÜÂ≠¶ÂÆ∂ËØ¥ÈáëÈí±‰π†ÊÉØÂèçÊò†‰∫ÜÊàë‰ª¨ÁöÑ‰ø°‰ª∞„ÄÇÈáëÈí±Ë±°ÂæÅÁùÄÊùÉÂäõÊàñÁà±„ÄÇÂº∫Ëø´ÊÄßËÆ®‰ª∑Ëøò‰ª∑ËÄÖ‰π∞‰∏úË•øÂè™ÊòØÂõ†‰∏∫‰æøÂÆúÔºå‰∏∫‰∫ÜÊÑüËßâËá™Â∑±Âú®‚ÄòËµ¢‚Äô„ÄÇ",
                        questions: [
                            { q: "1. Compulsive spender spends money ______.", opts: ["A. for pleasure", "B. for needs", "C. to meet psychological need", "D. feels cheated"], ans: "C" },
                            { q: "2. Compulsive bargain hunters search for low prices ______.", opts: ["A. save money", "B. boast triumph", "C. no money problems", "D. feel satisfied getting for less"], ans: "B" },
                            { q: "3. Text mainly about?", opts: ["A. Psychology of money-spending", "B. Compulsive spenders", "C. Bargain hunting", "D. Business use"], ans: "A" }
                        ]
                    }
                ]
            },
            {
                unit: "Unit 3: Global Warming",
                sections: [
                    {
                        title: "Text A: Global Warming - A New Tree Line",
                        text: "A climate model suggests that chopping down trees might cool the planet. Trees absorb carbon (good), but dark forests absorb sun heat (warming). Dr. Bala's model shows removing trees might cool the Earth due to reflectivity (albedo effect), especially in high latitudes like Russia/Canada. But trees are needed for carbon cycle.",
                        trans: "„ÄêText A ÁøªËØë„Äë‰∏Ä‰∏™Ê∞îÂÄôÊ®°ÂûãÂª∫ËÆÆÁ†ç‰ºêÊ†ëÊú®ÂèØËÉΩ‰ºöËÆ©Âú∞ÁêÉÈôçÊ∏©„ÄÇÊ†ëÊú®Âê∏Êî∂Á¢≥ÔºàÂ•ΩÔºâÔºå‰ΩÜÊ∑±Ëâ≤Ê£ÆÊûóÂê∏Êî∂Â§™Èò≥ÁÉ≠ÈáèÔºàÂ¢ûÊ∏©Ôºâ„ÄÇBalaÂçöÂ£´ÁöÑÊ®°ÂûãÊòæÁ§∫ÔºåÁßªÈô§Ê†ëÊú®ÂèØËÉΩ‰ºöÂõ†‰∏∫ÂèçÂ∞ÑÁéáÔºàÂèçÁÖßÁéáÊïàÂ∫îÔºâËÄå‰ΩøÂú∞ÁêÉÈôçÊ∏©ÔºåÁâπÂà´ÊòØÂú®‰øÑÁΩóÊñØ/Âä†ÊãøÂ§ßÁ≠âÈ´òÁ∫¨Â∫¶Âú∞Âå∫„ÄÇ",
                        questions: [
                            { q: "1. Rich people pay to plant trees because ______.", opts: ["A. photosynthesis absorbs CO2", "B. beauty", "C. transpiration", "D. wood"], ans: "A" },
                            { q: "2. Burning without offsetting leads to all EXCEPT ______.", opts: ["A. warmer world", "B. higher sea levels", "C. Maldives disappear", "D. world too hot to live in"], ans: "D" },
                            { q: "3. Trees change temp by following EXCEPT ______.", opts: ["A. provide shade for people", "B. absorb sun heat", "C. sequester carbon", "D. transpiration"], ans: "A" },
                            { q: "4. According to Paragraph 10 ______.", opts: ["A. Russia cooling", "B. Equator: cutting trees led to warming locally & globally", "C. Equator cooling", "D. Canada cooling"], ans: "B" }
                        ]
                    },
                    {
                        title: "Text B: Focus on Global Warming",
                        text: "Global warming is the single largest threat. Greenhouse gases like CO2 and methane trap heat. Industrial revolution increased levels. Effects: rising sea levels, glaciers melting. We must act: curb consumption, clean cars, stop deforestation.",
                        trans: "„ÄêText B ÁøªËØë„ÄëÂÖ®ÁêÉÂèòÊöñÊòØÊúÄÂ§ßÁöÑÂ®ÅËÉÅ„ÄÇÊ∏©ÂÆ§Ê∞î‰ΩìÂ¶Ç‰∫åÊ∞ßÂåñÁ¢≥ÂíåÁî≤ÁÉ∑‰ºöÊªûÁïôÁÉ≠Èáè„ÄÇÂ∑•‰∏öÈù©ÂëΩÂ¢ûÂä†‰∫ÜÊ∞î‰ΩìÊ∞¥Âπ≥„ÄÇÂΩ±ÂìçÔºöÊµ∑Âπ≥Èù¢‰∏äÂçáÔºåÂÜ∞Â∑ùËûçÂåñ„ÄÇÊàë‰ª¨ÂøÖÈ°ªË°åÂä®ÔºöÈôêÂà∂Ê∂àËÄóÔºå‰ΩøÁî®Ê∏ÖÊ¥ÅÊ±ΩËΩ¶ÔºåÂÅúÊ≠¢Ê£ÆÊûóÁ†ç‰ºê„ÄÇ",
                        questions: [
                            { q: "1. Mention Madonna/microwave to show ______.", opts: ["A. popularity of stars", "B. popularity of global warming idea", "C. no difference", "D. differences"], ans: "B" },
                            { q: "2. NOT reason for increased gases?", opts: ["A. Factories", "B. Garbage methane", "C. Fertilizers", "D. Cattle bred WITH methane"], ans: "D" },
                            { q: "3. Facts proving temp increase?", opts: ["A. Land hotter", "B. Hot days", "C. Glaciers getting smaller", "D. Ocean surface"], ans: "C" }
                        ]
                    }
                ]
            },
            {
                unit: "Unit 4: Leadership",
                sections: [
                    {
                        title: "Text A: What Makes a Leader",
                        text: "Not every president is a leader. Leaders appear in crisis (Churchill, Roosevelt). They simplify problems. They have unforgettable identities (Lincoln's hat). They project firmness. They must know how to use power. A leader follows the people's desires.",
                        trans: "„ÄêText A ÁøªËØë„Äë‰∏çÊòØÊØè‰∏™ÊÄªÁªüÈÉΩÊòØÈ¢ÜË¢ñ„ÄÇÈ¢ÜË¢ñÂá∫Áé∞Âú®Âç±Êú∫‰∏≠Ôºà‰∏òÂêâÂ∞îÔºåÁΩóÊñØÁ¶èÔºâ„ÄÇ‰ªñ‰ª¨ÁÆÄÂåñÈóÆÈ¢ò„ÄÇ‰ªñ‰ª¨Êúâ‰ª§‰∫∫ÈöæÂøòÁöÑÁâπÂæÅÔºàÊûóËÇØÁöÑÂ∏ΩÂ≠êÔºâ„ÄÇ‰ªñ‰ª¨Ë°®Áé∞Âá∫ÂùöÂÆö„ÄÇ‰ªñ‰ª¨ÂøÖÈ°ªÊáÇÂæóÂ¶Ç‰Ωï‰ΩøÁî®ÊùÉÂäõ„ÄÇÈ¢ÜË¢ñËøΩÈöè‰∫∫Ê∞ëÁöÑÊÑøÊúõ„ÄÇ",
                        questions: [
                            { q: "1. From para 4, a leader must ______.", opts: ["A. look special/different", "B. be tall", "C. look ordinary", "D. have figure"], ans: "A" },
                            { q: "2. Inferred about President Ford?", opts: ["A. Looked ordinary", "B. Unusual face", "C. Looked different", "D. Successful"], ans: "A" },
                            { q: "3. NOT reason for Roosevelt?", opts: ["A. Belly laugh", "B. Understandable solutions", "C. Easy manner (implied)", "D. Overcoming polio showed difference"], ans: "C" },
                            { q: "4. A leader ______.", opts: ["A. appeals to people", "B. tells what they want to hear", "C. encourages new thinking", "D. tells right/wrong"], ans: "A" }
                        ]
                    },
                    {
                        title: "Text B: The Leader (Giuliani)",
                        text: "New York Mayor Rudy Giuliani during 9/11. 'Become the calmest person in the room'. He stood defiant, soothed victims. He rescued NY from decline before 9/11 (crime drop). But he had controversies (civil rights, personal life). Now considering presidential run.",
                        trans: "„ÄêText B ÁøªËØë„ÄëÁ∫ΩÁ∫¶Â∏ÇÈïøRudy GiulianiÂú®911ÊúüÈó¥„ÄÇ‚ÄòÊàê‰∏∫ÊàøÈó¥ÈáåÊúÄÂÜ∑ÈùôÁöÑ‰∫∫‚Äô„ÄÇ‰ªñÂ±πÁ´ã‰∏çÂÄíÔºåÂÆâÊäöÂèóÂÆ≥ËÄÖ„ÄÇ‰ªñÂú®911ÂâçÂ∞ÜÁ∫ΩÁ∫¶‰ªéË°∞ÈÄÄ‰∏≠ÊãØÊïëÂá∫Êù•ÔºàÁäØÁΩ™Áéá‰∏ãÈôçÔºâ„ÄÇ‰ΩÜ‰ªñ‰πüÊúâ‰∫âËÆÆÔºàÊ∞ëÊùÉÔºåÁßÅÁîüÊ¥ªÔºâ„ÄÇÁé∞Âú®ËÄÉËôëÁ´ûÈÄâÊÄªÁªü„ÄÇ",
                        questions: [
                            { q: "(Text only - No questions provided in source file)", opts: ["A. Read carefully"], ans: "A" }
                        ]
                    }
                ]
            },
            {
                unit: "Unit 5: Intercultural Communication",
                sections: [
                    {
                        title: "Text A: Multiculturalism",
                        text: "A multicultural person is convinced all cultures are equally good. Multilingual vs Multicultural. Monocultural arrogance turns off customers. Hiring managers often neglect this. A multicultural salesperson can motivate foreigners.",
                        trans: "„ÄêText A ÁøªËØë„ÄëÂ§öÂÖÉÊñáÂåñ‰∏ª‰πâËÄÖÊ∑±‰ø°ÊâÄÊúâÊñáÂåñÈÉΩÂêåÊ†∑‰ºòÁßÄ„ÄÇÂ§öËØ≠Ë®Ä vs Â§öÂÖÉÊñáÂåñ„ÄÇÂçï‰∏ÄÁßçÊóèÁöÑÂÇ≤ÊÖ¢‰ºöËÆ©ÂÆ¢Êà∑ÂèçÊÑü„ÄÇÊãõËÅòÁªèÁêÜÁªèÂ∏∏ÂøΩËßÜËøô‰∏ÄÁÇπ„ÄÇÂ§öÂÖÉÊñáÂåñÁöÑÈîÄÂîÆ‰∫∫ÂëòÂèØ‰ª•ÊøÄÂä±Â§ñÂõΩ‰∫∫„ÄÇ",
                        questions: [
                            { q: "1. Multicultural person is TRUE?", opts: ["A. Explain advantages", "B. Fluent languages", "C. Traveled", "D. Believes all cultures equally important"], ans: "D" },
                            { q: "2. Learn from para 3?", opts: ["A. Foreigners arrogant", "B. People hide arrogance", "C. Monocultural sales fail to motivate", "D. Barriers"], ans: "C" },
                            { q: "3. Important quality for Pan-European sales?", opts: ["A. Fluent languages", "B. Experience", "C. Happy childhood", "D. Multicultural"], ans: "D" }
                        ]
                    },
                    {
                        title: "Text B: Diversity Programs",
                        text: "Cultural diversity programs are flourishing (Chrysler, CIA). Work force is growing diverse. Diversity is a competitive edge. Companies like Texas Instruments, Du Pont, Disney have strong programs.",
                        trans: "„ÄêText B ÁøªËØë„ÄëÊñáÂåñÂ§öÊ†∑ÊÄßÈ°πÁõÆÊ≠£Âú®Ëì¨ÂãÉÂèëÂ±ïÔºàÂÖãËé±ÊñØÂãíÔºå‰∏≠ÊÉÖÂ±ÄÔºâ„ÄÇÂä≥Âä®ÂäõÊ≠£ÂèòÂæóÂ§öÊ†∑Âåñ„ÄÇÂ§öÊ†∑ÊÄßÊòØ‰∏ÄÁßçÁ´û‰∫â‰ºòÂäø„ÄÇÂæ∑Â∑û‰ª™Âô®„ÄÅÊùúÈÇ¶„ÄÅËø™Â£´Â∞ºÁ≠âÂÖ¨Âè∏ÈÉΩÊúâÂº∫ÊúâÂäõÁöÑÈ°πÁõÆ„ÄÇ",
                        questions: [
                            { q: "1. 'Minority' refers to?", opts: ["A. Women", "B. African Americans", "C. Population", "D. All with different traditions"], ans: "D" },
                            { q: "2. NOT strategy at Texas Instruments?", opts: ["A. Recruiting", "B. Training", "C. Network", "D. Staff-rewarding program (Checking text: includes incentive compensation... maybe 'Setting up a network' is distinct?)"], ans: "C" },
                            { q: "3. Disney 'who they are' means?", opts: ["A. Remember names", "B. Value/respect characteristics", "C. Same characteristics", "D. Require same"], ans: "B" }
                        ]
                    }
                ]
            }
        ]
    };

    // ==========================================
    // ÈÄªËæëÊéßÂà∂ (Logic)
    // ==========================================

    let currentBook = 'book1';
    let userState = { score: 0, answers: {} };

    function init() {
        renderContent();
    }

    function switchBook(bookId) {
        currentBook = bookId;
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelector(`.tab-btn[onclick="switchBook('${bookId}')"]`).classList.add('active');
        // Reset view for new book
        document.body.classList.remove('show-trans', 'show-ans');
        renderContent();
    }

    function renderContent() {
        const container = document.getElementById('content-area');
        const data = db[currentBook];
        let html = '';

        data.forEach((unit, uIdx) => {
            html += `<div class="unit-card">
                        <div class="unit-title">${unit.unit}</div>`;
            
            unit.sections.forEach((sec, sIdx) => {
                html += `<div class="section-title">${sec.title}</div>`;
                
                if (sec.text) {
                    html += `<div class="text-content">${sec.text}</div>`;
                }
                if (sec.trans) {
                    html += `<div class="trans-content">${sec.trans}</div>`;
                }

                if (sec.questions) {
                    sec.questions.forEach((q, qIdx) => {
                        const qId = `${currentBook}-u${uIdx}-s${sIdx}-q${qIdx}`;
                        html += `
                        <div class="question-item" id="${qId}">
                            <div class="q-stem">${q.q}</div>
                            <div class="options-grid">
                                ${q.opts.map(opt => 
                                    `<button class="opt-btn" onclick="check('${qId}', '${opt.charAt(0)}', '${q.ans}')">${opt}</button>`
                                ).join('')}
                            </div>
                            <div class="answer-key">Ê≠£Á°ÆÁ≠îÊ°à: ${q.ans}</div>
                        </div>`;
                    });
                }
            });
            html += `</div>`;
        });

        container.innerHTML = html;
    }

    function check(qId, selected, correct) {
        const qEl = document.getElementById(qId);
        if (qEl.classList.contains('answered')) return; // Prevent re-answering
        
        qEl.classList.add('answered');
        const btns = qEl.querySelectorAll('.opt-btn');
        
        btns.forEach(btn => {
            const optLetter = btn.innerText.charAt(0);
            if (optLetter === correct) {
                btn.classList.add('correct');
            }
            if (optLetter === selected && selected !== correct) {
                btn.classList.add('wrong');
            }
        });
    }

    function toggleTrans() {
        document.body.classList.toggle('show-trans');
        const btn = document.querySelector('.btn-trans');
        btn.classList.toggle('active');
        btn.innerText = document.body.classList.contains('show-trans') ? "ÈöêËóèÁøªËØë" : "‰∏≠Ëã±ÂØπÁÖß";
    }

    function toggleAns() {
        document.body.classList.toggle('show-ans');
        const btn = document.querySelector('.btn-ans');
        btn.classList.toggle('active');
    }

    function exportWord() {
        const header = `<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
        <head><meta charset='utf-8'><title>Export</title></head><body>`;
        
        // Clone content to modify for export
        const content = document.getElementById('content-area').cloneNode(true);
        
        // Remove interactive elements for Word
        content.querySelectorAll('button').forEach(b => {
            const p = document.createElement('p');
            p.innerText = b.innerText;
            b.parentNode.replaceChild(p, b);
        });

        // Ensure translations/answers are visible
        content.querySelectorAll('.trans-content').forEach(el => el.style.display = 'block');
        content.querySelectorAll('.answer-key').forEach(el => el.style.display = 'block');

        const sourceHTML = header + content.innerHTML + "</body></html>";
        const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
        
        const link = document.createElement("a");
        document.body.appendChild(link);
        link.href = source;
        link.download = `${currentBook === 'book1' ? 'Comprehensive_Course' : 'Reading_Course'}_Export.doc`;
        link.click();
        document.body.removeChild(link);
    }

    // Start
    init();

</script>

</body>
</html>